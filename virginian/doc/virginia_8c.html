<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Virginian: src/vm/virginia.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Virginian</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">src/vm/virginia.c File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="virginian_8h_source.html">virginian.h</a>&quot;</code><br/>
</div>
<p><a href="virginia_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4513bef1a5a609b67c2ab4a4d5071bad"></a><!-- doxytag: member="virginia.c::__MULTI" ref="a4513bef1a5a609b67c2ab4a4d5071bad" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>__MULTI</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virginia_8c.html#ae9c07c2544277918fd2ce691b2e8f91c">GETP1</a>&#160;&#160;&#160;p1 = <a class="el" href="vm__gpu_8cu.html#a946d0d35b3bc20faef9b521a79e7e89a">vm</a>-&gt;stmt[context.pc].p1;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virginia_8c.html#ac82147a944db7502131aac0d5952c951">GETP2</a>&#160;&#160;&#160;p2 = <a class="el" href="vm__gpu_8cu.html#a946d0d35b3bc20faef9b521a79e7e89a">vm</a>-&gt;stmt[context.pc].p2;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virginia_8c.html#a84944dc56b42abd52e2b118ea5988f78">GETP3</a>&#160;&#160;&#160;p3 = <a class="el" href="vm__gpu_8cu.html#a946d0d35b3bc20faef9b521a79e7e89a">vm</a>-&gt;stmt[context.pc].p3;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virginia_8c.html#a5928cf89ab28aa386703bbe4eb1090a4">REGCMP</a>(op)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="virginia_8c.html#a297d507b2e5432fbe16ea9bd8cceed7b">MATHOP</a>(op)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm.html#ga5eaa0064c9e2b63ad19d7e3ea95da9c0">virginia_single</a> (<a class="el" href="structvirginian.html">virginian</a> *v, <a class="el" href="structvirg__vm.html">virg_vm</a> *<a class="el" href="vm__gpu_8cu.html#a946d0d35b3bc20faef9b521a79e7e89a">vm</a>, <a class="el" href="structvirg__tablet__meta.html">virg_tablet_meta</a> *tab, <a class="el" href="structvirg__tablet__meta.html">virg_tablet_meta</a> **res_, unsigned row, unsigned num_rows)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the data-parallel portion of an opcode program on a single core.  <a href="group__vm.html#ga5eaa0064c9e2b63ad19d7e3ea95da9c0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__vm.html#gac8a59abde2076fa5dad105b0ec11cf5f">virginia_multi</a> (void *arg_)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the data-parallel portion of an opcode program on multiple cores.  <a href="group__vm.html#gac8a59abde2076fa5dad105b0ec11cf5f"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><h2><a class="anchor" id="Description"></a>
Description</h2>
<p>This file contains both the <a class="el" href="group__vm.html#ga5eaa0064c9e2b63ad19d7e3ea95da9c0" title="Execute the data-parallel portion of an opcode program on a single core.">virginia_single()</a> and <a class="el" href="group__vm.html#gac8a59abde2076fa5dad105b0ec11cf5f" title="Execute the data-parallel portion of an opcode program on multiple cores.">virginia_multi()</a> functions. If the __SINGLE macro is set, the former will be compiled from this file, otherwise the latter. It is constructed this way because these two functions share most of their code, but the multi-core version must be thread-safe and handles getting a new data tablet to process itself rather than returning. Additionally the function arguments are all stored in a single struct in the multi-core version because pthread_create() can only pass a single argument, so these values must be unpacked to variables. </p>

<p>Definition in file <a class="el" href="virginia_8c_source.html">virginia.c</a>.</p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="ae9c07c2544277918fd2ce691b2e8f91c"></a><!-- doxytag: member="virginia.c::GETP1" ref="ae9c07c2544277918fd2ce691b2e8f91c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GETP1&#160;&#160;&#160;p1 = <a class="el" href="vm__gpu_8cu.html#a946d0d35b3bc20faef9b521a79e7e89a">vm</a>-&gt;stmt[context.pc].p1;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Convenience macro to load the 1st argument of the current op into variable p1 </p>

<p>Definition at line <a class="el" href="virginia_8c_source.html#l00028">28</a> of file <a class="el" href="virginia_8c_source.html">virginia.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac82147a944db7502131aac0d5952c951"></a><!-- doxytag: member="virginia.c::GETP2" ref="ac82147a944db7502131aac0d5952c951" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GETP2&#160;&#160;&#160;p2 = <a class="el" href="vm__gpu_8cu.html#a946d0d35b3bc20faef9b521a79e7e89a">vm</a>-&gt;stmt[context.pc].p2;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Convenience macro to load the 2nd argument of the current op into variable p2 </p>

<p>Definition at line <a class="el" href="virginia_8c_source.html#l00033">33</a> of file <a class="el" href="virginia_8c_source.html">virginia.c</a>.</p>

</div>
</div>
<a class="anchor" id="a84944dc56b42abd52e2b118ea5988f78"></a><!-- doxytag: member="virginia.c::GETP3" ref="a84944dc56b42abd52e2b118ea5988f78" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GETP3&#160;&#160;&#160;p3 = <a class="el" href="vm__gpu_8cu.html#a946d0d35b3bc20faef9b521a79e7e89a">vm</a>-&gt;stmt[context.pc].p3;</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Convenience macro to load the 3rd argument of the current op into variable p3 </p>

<p>Definition at line <a class="el" href="virginia_8c_source.html#l00038">38</a> of file <a class="el" href="virginia_8c_source.html">virginia.c</a>.</p>

</div>
</div>
<a class="anchor" id="a297d507b2e5432fbe16ea9bd8cceed7b"></a><!-- doxytag: member="virginia.c::MATHOP" ref="a297d507b2e5432fbe16ea9bd8cceed7b" args="(op)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MATHOP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">op</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This is a convenience macro for opcodes such as Add and Mul to handle switching the math operator in this block of code so that it doesn't need to be duplicated. It is intended to be called like MATHOP(+). </p>

<p>Definition at line <a class="el" href="virginia_8c_source.html#l00138">138</a> of file <a class="el" href="virginia_8c_source.html">virginia.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5928cf89ab28aa386703bbe4eb1090a4"></a><!-- doxytag: member="virginia.c::REGCMP" ref="a5928cf89ab28aa386703bbe4eb1090a4" args="(op)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REGCMP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">op</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This is a convenience macro for the opcodes that change the program counter based on a comparison between two registers, such as Ge and Lt. I've written it this way because this is the only way to handle switching the operator in an equation at compile time, and I did not want to duplicate this code for 5 or 6 different ops. It is intended to be called like REGCMP(&lt;=) for a less than or equal comparison. </p>

<p>Definition at line <a class="el" href="virginia_8c_source.html#l00048">48</a> of file <a class="el" href="virginia_8c_source.html">virginia.c</a>.</p>

</div>
</div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Wed Feb 15 2012 01:21:46 for Virginian by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
